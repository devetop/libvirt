---
layout: post
title:  "virtiofs"
date: 2022-12-30 22:04:00 +0700
categories: jekyll update
---


Buat xml memorybacking
```sh
virt-xml <domain> --edit --memorybacking access.mode=shared,source.type=memfd
```

{% highlight ruby %}
[root@srv1 ~]# virt-xml domain --edit --memorybacking access.mode=shared,source.type=memfd
Domain 'cent8-vm1' defined successfully.
Changes will take effect after the domain is fully powered off.
{% endhighlight %}

Selanjutnya poweroff VM dan start kembali

Buat xml untuk virtiofs
 
virt-xml <domain> --build-xml --print-xml --filesystem /mnt/iso/,isoblk,driver.type=virtofs,accessmode=passthrough

{% highlight ruby %}
[root@srv1 ~]# virt-xml domain --build-xml --print-xml --filesystem /mnt/iso/,isoblk,driver.type=virtofs,accessmode=passthrough
<filesystem accessmode="passthrough" type="mount">
  <source dir="/mnt/iso/"/>
  <target dir="isoblk"/>
  <driver type="virtofs"/>
</filesystem>
{% endhighlight %}

attach ke live VM dengan perintah berikut
 
virsh attach-device --domain <domain> --file fs.xml  --live

OUTPUT:
 
[root@srv1 ~]# virsh attach-device --domain domain --file fs.xml  --live

Device attached successfully
